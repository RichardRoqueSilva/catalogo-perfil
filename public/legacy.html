<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Página Legada com jQuery</title>
    <!-- Incluindo Bootstrap via CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Estilos simples para esta página */
        body { background-color: #f0f0f0; }
        #user-list .list-group-item { cursor: pointer; }
        #user-list .list-group-item:hover { background-color: #e9ecef; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <header class="text-center p-3 mb-4 bg-light rounded shadow-sm">
            <h1>Catálogo de Perfis (Versão jQuery)</h1>
            <p class="lead">Demonstração da mesma funcionalidade com manipulação direta do DOM.</p>
        </header>

        <div id="loading-indicator" class="text-center">
            <p>Carregando usuários...</p>
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>

        <div id="error-message" class="alert alert-danger" style="display: none;"></div>

        <main class="row" style="display: none;">
            <section class="col-md-5">
                <h2 class="h4 mb-3">Lista de Usuários</h2>
                <!-- A lista de usuários será inserida aqui pelo jQuery -->
                <ul id="user-list" class="list-group"></ul>
            </section>
            
            <section class="col-md-7">
                <h2 class="h4 mb-3">Detalhes do Usuário</h2>
                <!-- Os detalhes do usuário serão inseridos aqui -->
                <div id="user-details-container">
                    <div class="card">
                        <div class="card-body text-center text-muted">
                            Selecione um usuário na lista para ver os detalhes.
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="text-center mt-5 border-top pt-3">
            <a href="/" class="btn btn-primary">← Voltar para a Aplicação React Moderna</a>
        </footer>
    </div>

    <!-- Incluindo jQuery via CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        // O código é executado quando o documento está pronto
        $(document).ready(function() {
            // --- 1. BUSCANDO OS DADOS (Abordagem Imperativa) ---
            // Usamos a função $.ajax do jQuery para fazer a chamada de API.
            $.ajax({
                url: 'https://jsonplaceholder.typicode.com/users',
                method: 'GET',
                success: function(users) {
                    // SE A CHAMADA FOR BEM-SUCEDIDA:
                    // Escondemos o indicador de "carregando" e mostramos o conteúdo principal.
                    $('#loading-indicator').hide();
                    $('main').show();
                    
                    // --- 2. RENDERIZANDO A LISTA (Manipulação Direta do DOM) ---
                    const userListElement = $('#user-list');
                    // Iteramos sobre os dados recebidos com a função $.each do jQuery.
                    $.each(users, function(index, user) {
                        // Para cada usuário, criamos um elemento <li> com jQuery.
                        const listItem = $('<li></li>')
                            .addClass('list-group-item')
                            .text(user.name)
                            // Armazenamos o objeto completo do usuário no próprio elemento HTML
                            // usando a função .data(). Isso é uma prática comum em jQuery.
                            .data('user-data', user);
                        
                        // Adicionamos (append) o novo <li> à nossa <ul>.
                        userListElement.append(listItem);
                    });
                },
                error: function(err) {
                    // SE A CHAMADA FALHAR:
                    // Escondemos o "carregando" e mostramos a mensagem de erro.
                    $('#loading-indicator').hide();
                    const errorElement = $('#error-message');
                    errorElement.text('Falha ao buscar dados. Tente recarregar a página.');
                    errorElement.show();
                }
            });

            // --- 3. LIDANDO COM EVENTOS (Manipulação Direta do DOM) ---
            // Usamos a delegação de eventos. Em vez de adicionar um clique a cada <li>,
            // adicionamos um único listener na <ul> pai (#user-list).
            // Isso é mais performático, especialmente para listas grandes.
            $('#user-list').on('click', 'li', function() {
                // `this` aqui se refere ao <li> que foi clicado.
                const clickedListItem = $(this);
                
                // Remove a classe 'active' de qualquer outro item que a tenha.
                $('#user-list li').removeClass('active');
                // Adiciona a classe 'active' ao item clicado.
                clickedListItem.addClass('active');

                // Recuperamos o objeto de usuário que armazenamos com .data().
                const userData = clickedListItem.data('user-data');
                
                // --- 4. ATUALIZANDO A UI DE DETALHES (Manipulação Direta do DOM) ---
                // Criamos o HTML para o card de detalhes como uma string.
                const detailsHtml = `
                    <div class="card shadow-sm">
                        <div class="card-header">
                            <h5 class="mb-0">${userData.name}</h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text"><strong>Email:</strong> ${userData.email}</p>
                            <p class="card-text"><strong>Telefone:</strong> ${userData.phone}</p>
                            <p class="card-text"><strong>Website:</strong> <a href="http://${userData.website}" target="_blank" rel="noopener noreferrer">${userData.website}</a></p>
                        </div>
                    </div>
                `;

                // Substituímos o conteúdo do container de detalhes pelo novo HTML.
                $('#user-details-container').html(detailsHtml);
            });
        });
    </script>
</body>
</html>